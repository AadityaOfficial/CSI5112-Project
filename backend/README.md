
# csi5112_project backend

## Getting Started

### Install

Ensure all dependencies are installed

```
dotnet restore
```

### Run

To run the application

```
dotnet run
```

### Development

All development code are under the root folder.

This project is using MVC architecture (Model, View and Controller)

`./Models` folder contains all data model files

`./Views` folder contains all actions can be applied to the models

`./Controllers` folder contains all the network interface related code

There are other folders that are not significant. See code for details. 


### Testing

`../backend_tests` is an individual project that contains integration testing for this project.
It was developed to help with the backend development effort.
Since those tests are not in the scope of the deliverables, they are not maintained. If new code update breaks the tests, 
the tests will be disabled. 


### API spec

The data model and service functions are documented in the format of openAPI. See [official documents](https://swagger.io/specification/) for how to interpret the below specs

Or access `https://application.egrotech.net/swagger/index.html` to see openAPI docs generated by Swagger

Or access `https://localhost:7156/swagger/index.html` after starting the backend locally


<details>
  <summary>Click to see the spec</summary>
  
 ```json
 {
   "openapi":"3.0.1",
   "info":{
      "title":"backend",
      "version":"1.0"
   },
   "paths":{
      "/api/Answer":{
         "get":{
            "tags":[
               "Answer"
            ],
            "parameters":[
               {
                  "name":"page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":0
                  }
               },
               {
                  "name":"per_page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":50
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Answer"
                           }
                        }
                     },
                     "application/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Answer"
                           }
                        }
                     },
                     "text/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Answer"
                           }
                        }
                     }
                  }
               }
            }
         },
         "post":{
            "tags":[
               "Answer"
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Answer"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Answer"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/Answer"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/Answer/{id}":{
         "get":{
            "tags":[
               "Answer"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "$ref":"#/components/schemas/Answer"
                        }
                     },
                     "application/json":{
                        "schema":{
                           "$ref":"#/components/schemas/Answer"
                        }
                     },
                     "text/json":{
                        "schema":{
                           "$ref":"#/components/schemas/Answer"
                        }
                     }
                  }
               }
            }
         },
         "put":{
            "tags":[
               "Answer"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Answer"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Answer"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/Answer"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         },
         "delete":{
            "tags":[
               "Answer"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/Answer/__question__":{
         "get":{
            "tags":[
               "Answer"
            ],
            "parameters":[
               {
                  "name":"question_id",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Answer"
                           }
                        }
                     },
                     "application/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Answer"
                           }
                        }
                     },
                     "text/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Answer"
                           }
                        }
                     }
                  }
               }
            }
         }
      },
      "/api/Item":{
         "get":{
            "tags":[
               "Item"
            ],
            "parameters":[
               {
                  "name":"page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":0
                  }
               },
               {
                  "name":"per_page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":50
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Item"
                           }
                        }
                     },
                     "application/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Item"
                           }
                        }
                     },
                     "text/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Item"
                           }
                        }
                     }
                  }
               }
            }
         },
         "post":{
            "tags":[
               "Item"
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Item"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Item"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/Item"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/Item/{id}":{
         "get":{
            "tags":[
               "Item"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "$ref":"#/components/schemas/Item"
                        }
                     },
                     "application/json":{
                        "schema":{
                           "$ref":"#/components/schemas/Item"
                        }
                     },
                     "text/json":{
                        "schema":{
                           "$ref":"#/components/schemas/Item"
                        }
                     }
                  }
               }
            }
         },
         "put":{
            "tags":[
               "Item"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Item"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Item"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/Item"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         },
         "delete":{
            "tags":[
               "Item"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/OrderHistory":{
         "get":{
            "tags":[
               "OrderHistory"
            ],
            "parameters":[
               {
                  "name":"page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":0
                  }
               },
               {
                  "name":"per_page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":50
                  }
               },
               {
                  "name":"userId",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int64",
                     "default":-1
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/OrderHistory"
                           }
                        }
                     },
                     "application/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/OrderHistory"
                           }
                        }
                     },
                     "text/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/OrderHistory"
                           }
                        }
                     }
                  }
               }
            }
         },
         "post":{
            "tags":[
               "OrderHistory"
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/OrderHistory"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/OrderHistory"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/OrderHistory"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/OrderHistory/{id}":{
         "get":{
            "tags":[
               "OrderHistory"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               },
               {
                  "name":"userId",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int64",
                     "default":-1
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "$ref":"#/components/schemas/OrderHistory"
                        }
                     },
                     "application/json":{
                        "schema":{
                           "$ref":"#/components/schemas/OrderHistory"
                        }
                     },
                     "text/json":{
                        "schema":{
                           "$ref":"#/components/schemas/OrderHistory"
                        }
                     }
                  }
               }
            }
         },
         "put":{
            "tags":[
               "OrderHistory"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/OrderHistory"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/OrderHistory"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/OrderHistory"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         },
         "delete":{
            "tags":[
               "OrderHistory"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/Question":{
         "get":{
            "tags":[
               "Question"
            ],
            "parameters":[
               {
                  "name":"page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":0
                  }
               },
               {
                  "name":"per_page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":50
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Question"
                           }
                        }
                     },
                     "application/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Question"
                           }
                        }
                     },
                     "text/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Question"
                           }
                        }
                     }
                  }
               }
            }
         },
         "post":{
            "tags":[
               "Question"
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Question"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Question"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/Question"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/Question/__search__/{search_key}":{
         "get":{
            "tags":[
               "Question"
            ],
            "parameters":[
               {
                  "name":"search_key",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"string"
                  }
               },
               {
                  "name":"page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":0
                  }
               },
               {
                  "name":"per_page",
                  "in":"query",
                  "schema":{
                     "type":"integer",
                     "format":"int32",
                     "default":50
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Question"
                           }
                        }
                     },
                     "application/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Question"
                           }
                        }
                     },
                     "text/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/Question"
                           }
                        }
                     }
                  }
               }
            }
         }
      },
      "/api/Question/{id}":{
         "get":{
            "tags":[
               "Question"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "$ref":"#/components/schemas/Question"
                        }
                     },
                     "application/json":{
                        "schema":{
                           "$ref":"#/components/schemas/Question"
                        }
                     },
                     "text/json":{
                        "schema":{
                           "$ref":"#/components/schemas/Question"
                        }
                     }
                  }
               }
            }
         },
         "put":{
            "tags":[
               "Question"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Question"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/Question"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/Question"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         },
         "delete":{
            "tags":[
               "Question"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/User":{
         "get":{
            "tags":[
               "User"
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/User"
                           }
                        }
                     },
                     "application/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/User"
                           }
                        }
                     },
                     "text/json":{
                        "schema":{
                           "type":"array",
                           "items":{
                              "$ref":"#/components/schemas/User"
                           }
                        }
                     }
                  }
               }
            }
         },
         "post":{
            "tags":[
               "User"
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/User"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/User"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/User"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      },
      "/api/User/{id}":{
         "get":{
            "tags":[
               "User"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success",
                  "content":{
                     "text/plain":{
                        "schema":{
                           "$ref":"#/components/schemas/User"
                        }
                     },
                     "application/json":{
                        "schema":{
                           "$ref":"#/components/schemas/User"
                        }
                     },
                     "text/json":{
                        "schema":{
                           "$ref":"#/components/schemas/User"
                        }
                     }
                  }
               }
            }
         },
         "put":{
            "tags":[
               "User"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "requestBody":{
               "content":{
                  "application/json":{
                     "schema":{
                        "$ref":"#/components/schemas/User"
                     }
                  },
                  "text/json":{
                     "schema":{
                        "$ref":"#/components/schemas/User"
                     }
                  },
                  "application/*+json":{
                     "schema":{
                        "$ref":"#/components/schemas/User"
                     }
                  }
               }
            },
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         },
         "delete":{
            "tags":[
               "User"
            ],
            "parameters":[
               {
                  "name":"id",
                  "in":"path",
                  "required":true,
                  "schema":{
                     "type":"integer",
                     "format":"int64"
                  }
               }
            ],
            "responses":{
               "200":{
                  "description":"Success"
               }
            }
         }
      }
   },
   "components":{
      "schemas":{
         "Answer":{
            "type":"object",
            "properties":{
               "answer":{
                  "type":"string",
                  "nullable":true
               },
               "user":{
                  "$ref":"#/components/schemas/User"
               },
               "time":{
                  "type":"string",
                  "format":"date-time"
               },
               "questionId":{
                  "type":"integer",
                  "format":"int32"
               },
               "id":{
                  "type":"integer",
                  "format":"int64"
               }
            },
            "additionalProperties":false
         },
         "Item":{
            "type":"object",
            "properties":{
               "name":{
                  "type":"string",
                  "nullable":true
               },
               "category":{
                  "type":"string",
                  "nullable":true
               },
               "description":{
                  "type":"string",
                  "nullable":true
               },
               "imageUrl":{
                  "type":"string",
                  "nullable":true
               },
               "price":{
                  "type":"number",
                  "format":"double"
               },
               "id":{
                  "type":"integer",
                  "format":"int64"
               }
            },
            "additionalProperties":false
         },
         "OrderHistory":{
            "type":"object",
            "properties":{
               "isPaid":{
                  "type":"boolean"
               },
               "amount":{
                  "type":"number",
                  "format":"double"
               },
               "user":{
                  "$ref":"#/components/schemas/User"
               },
               "items":{
                  "type":"string",
                  "nullable":true
               },
               "time":{
                  "type":"string",
                  "format":"date-time"
               },
               "id":{
                  "type":"integer",
                  "format":"int64"
               }
            },
            "additionalProperties":false
         },
         "Question":{
            "type":"object",
            "properties":{
               "title":{
                  "type":"string",
                  "nullable":true
               },
               "description":{
                  "type":"string",
                  "nullable":true
               },
               "user":{
                  "$ref":"#/components/schemas/User"
               },
               "time":{
                  "type":"string",
                  "format":"date-time"
               },
               "replies":{
                  "type":"integer",
                  "format":"int32"
               },
               "id":{
                  "type":"integer",
                  "format":"int64"
               }
            },
            "additionalProperties":false
         },
         "User":{
            "type":"object",
            "properties":{
               "username":{
                  "type":"string",
                  "nullable":true
               },
               "password":{
                  "type":"string",
                  "nullable":true
               },
               "userType":{
                  "type":"string",
                  "nullable":true
               },
               "id":{
                  "type":"integer",
                  "format":"int64"
               }
            },
            "additionalProperties":false
         }
      }
   }
}
 ```
</details>